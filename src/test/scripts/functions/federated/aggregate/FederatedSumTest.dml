if ($rP) {
    A = federated(addresses=list($in_X1, $in_X2, $in_X3, $in_X4),
        ranges=list(list(0, 0), list($rows/4, $cols), list($rows/4, 0), list(2*$rows/4, $cols),
    		list(2*$rows/4, 0), list(3*$rows/4, $cols), list(3*$rows/4, 0), list($rows, $cols)));
} else {
    A = federated(addresses=list($in_X1, $in_X2, $in_X3, $in_X4),
            ranges=list(list(0, 0), list($rows, $cols/4), list(0,$cols/4), list($rows, $cols/2),
            	list(0,$cols/2), list($rows, 3*($cols/4)), list(0, 3*($cols/4)), list($rows, $cols)));
}

s = sum(A);

write(s, $out_S);